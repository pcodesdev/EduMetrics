# EduMetrics — Insight Rules Reference

All rules are evaluated in [`core/insights.py`](../backend/core/insights.py). Human-readable text is generated by [`core/narrative.py`](../backend/core/narrative.py).

---

## Severity Levels

| Severity | Meaning |
|---|---|
| `critical` | Requires immediate action — systemic failure or very high risk |
| `warning` | Needs attention this term — notable gap or underperformance |
| `info` | Informational — positive signals, correlations, or context |

---

## Performance Rules

### `perf_low_overall_mean`
- **Condition**: School-wide overall mean < `pass_mark`
- **Severity**: `critical` if mean < pass_mark − 15; else `warning`
- **Rationale**: A school mean below the pass mark indicates systemic academic challenges.

### `perf_good_overall_mean`
- **Condition**: School-wide overall mean ≥ `pass_mark`
- **Severity**: `info`
- **Rationale**: Confirms the school is meeting the baseline standard.

### `perf_high_fail_rate`
- **Condition**: Overall fail rate > 40%
- **Severity**: `critical` if > 60%; else `warning`
- **Rationale**: More than 4 in 10 student-subject scores failing indicates a widespread problem.

### `perf_weakest_subject`
- **Condition**: Lowest subject mean is > 10 points below the school average
- **Severity**: `warning`
- **Rationale**: A subject significantly trailing the school average warrants focused attention.

### `perf_subject_high_fail_{subject}`
- **Condition**: Subject fail rate > 50%
- **Severity**: `critical` if > 70%; else `warning`
- **Rationale**: Majority of students failing a single subject requires curriculum/teaching review.

---

## Gap Rules

### `gap_gender_{label}`
- **Condition**: Gender gap with p < 0.05 **and** |Cohen's d| > 0.2
- **Severity**: `critical` if effect size is medium or large; else `warning`
- **Rationale**: Statistically confirmed gender disparity with meaningful effect size.

### `gap_class`
- **Condition**: Class gap is statistically significant (p < 0.05)
- **Severity**: `critical` if gap > 15 points; else `warning`
- **Rationale**: Uneven class performance suggests resource or teaching quality differences.

### `gap_regional`
- **Condition**: Regional gap is statistically significant (p < 0.05)
- **Severity**: `critical` if gap > 20 points; else `warning`
- **Rationale**: Regional disparities indicate equity issues in resource distribution.

### `gap_term`
- **Condition**: Term gap > 5 points
- **Severity**: `warning` if > 10; else `info`
- **Rationale**: Large swings across terms may indicate curriculum pacing or external disruption.

---

## At-Risk Rules

### `risk_summary`
- **Condition**: ≥ 1 student at high risk
- **Severity**: `critical` if high_risk_pct > 25%; `warning` if > 15%; else `info`
- **Rationale**: The proportion of high-risk students determines the urgency of response.

### `risk_cluster_{class}`
- **Condition**: A class has ≥ 3 high-risk students
- **Severity**: `critical`
- **Rationale**: Multiple at-risk students in one class suggests a class-level issue.

---

## Positive Rules

### `pos_top_{student}`
- **Condition**: Student mean ≥ 80% (top 3 students)
- **Severity**: `info`
- **Rationale**: Top performers should be recognised and can serve as peer mentors.

### `pos_improving_{student}`
- **Condition**: Student score trend slope > +3 points per term (2+ terms required)
- **Severity**: `info`
- **Rationale**: Strong improvement trajectories should be acknowledged and studied.

### `pos_strong_{subject}`
- **Condition**: Subject pass rate ≥ 85%
- **Severity**: `info`
- **Rationale**: Strong subjects can serve as models for instructional practice.

### `pos_improving_trend`
- **Condition**: Last term mean > first term mean + 2 points
- **Severity**: `info`
- **Rationale**: An overall upward trend suggests interventions are working.

---

## Correlation Rules

### `corr_{subject_a}_{subject_b}`
- **Condition**: Pearson |r| > 0.6 **and** p < 0.05
- **Severity**: `info`
- **Rationale**: Strong correlations reveal cross-subject relationships for curriculum planning.
